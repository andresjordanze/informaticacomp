<CENTER><H1><%= @order.numero_pedido %> </H1>

<p>
    <strong>Fecha</strong><br>
    <%= @order.created_at %>
</p>

<p>
    <strong>Proveedor</strong><br>
    <%= @order.provider %>
</p>

<Center>

<h2>Productos:</h2>
<table border=1>
  <tr>
    <th>Nombre</th>
    <th>Codigo</th>  
    <th>Cantidad</th>
    <th>Estado</th>
  </tr>

<% cantidad=@order.productorders.length%>
<% if cantidad == 0 %>
<% nuevo = true %>
<% end %>
<% @order.productorders.each do |productito| %>
  <tr>
    <td><CENTER><%= productito.nombre_producto%></CENTER></td>
    <td><CENTER><%= productito.code %></CENTER></td>
    <td><CENTER><%= productito.quantity %></CENTER></td>
    <%if productito.ingresado == true%>
      <% cantidad -= 1 %>
      <% nuevo = false %>
      <td>Ingresado</td>
    <%else%>
    <% cantidad += 1 %>
    <% nuevo = false %>
      <td>Pendiente</td>
    <%end%>
    <td><%=link_to "Ver", :controller => :productorders, :action => 'show', :id => productito.id, :order_id => @order.numero_pedido %></td> 
    <% if productito.ingresado == false %>
    <td><%=link_to "Editar", :controller => :productorders, :action => 'edit', :id => productito.id, :order_id => @order.numero_pedido %></td>
    <td><%= link_to 'Eliminar de pedido', :controller => :productorders, :action => 'eliminar_producto_pedido', :id => productito.id, :order_id => @order.numero_pedido %></td>
    <td><%= link_to 'Registrar ingreso', :controller => :products, :action => "registrar_ingreso", :id => productito.id %></td>
    <% end %>
  </tr>
<% end %>
</table>
</Center>
<br><br>

<%if nuevo == true || cantidad > 0 %>
  <h2>Agregar Producto a Pedido:</h2>
  <Center><%= link_to_function "Formulario de Productos", "$('#hide').toggle()" %></Center>
  <div id="hide" style="display:none">
    <%= render "productorders/form" %>
  </div>
<%else%>
  <% @order.ingresado = true %>
<%end%>

<%= button_to 'Volver', orders_path, :method => :get, :class => 'btn btn-default' %><br>

  </CENTER>